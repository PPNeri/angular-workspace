/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * @license
 * Copyright Workylab. All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://raw.githubusercontent.com/workylab/materialize-angular/master/LICENSE
 */
import { Component, ContentChildren, Input, QueryList } from '@angular/core';
import { config } from '../../config';
import { getOffseTop } from '../../utils/get-offset-top.util';
import { GlossaryItemComponent } from './glossary-item/glossary-item.component';
import { Router } from '@angular/router';
var GlossaryComponent = /** @class */ (function () {
    function GlossaryComponent(router) {
        this.router = router;
        this.className = GlossaryComponent.defaultProps.className;
        this.scrollSpy = GlossaryComponent.defaultProps.scrollSpy;
        this.topSpace = GlossaryComponent.defaultProps.topSpace;
        this.prefix = config.components.prefix;
        this.activeReferenceId = '';
        this.onClickItem = this.onClickItem.bind(this);
        this.registerOptions = this.registerOptions.bind(this);
        this.update = this.update.bind(this);
    }
    /**
     * @return {?}
     */
    GlossaryComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.registerOptions();
        setTimeout(this.update, 30);
        if (this.scrollSpy) {
            this.scrollSpy.onChangeEmitter.subscribe((/**
             * @param {?} referenceId
             * @return {?}
             */
            function (referenceId) {
                _this.activeReferenceId = referenceId;
                _this.activeItemByReferenceId(referenceId);
            }));
        }
    };
    /**
     * @return {?}
     */
    GlossaryComponent.prototype.update = /**
     * @return {?}
     */
    function () {
        this.activeReferenceId = this.getActiveReferenceId();
        this.activeItemByReferenceId(this.activeReferenceId);
        this.scrollTo(this.activeReferenceId);
    };
    /**
     * @param {?} referenceId
     * @return {?}
     */
    GlossaryComponent.prototype.scrollTo = /**
     * @param {?} referenceId
     * @return {?}
     */
    function (referenceId) {
        /** @type {?} */
        var element = document.getElementById(referenceId);
        if (element) {
            /** @type {?} */
            var elementOffsetTop = getOffseTop(element);
            /** @type {?} */
            var scrollTop_1 = elementOffsetTop - this.topSpace;
            setTimeout((/**
             * @return {?}
             */
            function () { return window.scrollTo(0, scrollTop_1); }), 150);
        }
    };
    /**
     * @return {?}
     */
    GlossaryComponent.prototype.getActiveReferenceId = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var routerTree = this.router.parseUrl(this.router.url);
        if (routerTree && routerTree.fragment) {
            return routerTree.fragment;
        }
        return '';
    };
    /**
     * @return {?}
     */
    GlossaryComponent.prototype.registerOptions = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item.onClickEmitter.subscribe(_this.onClickItem);
        }));
    };
    /**
     * @param {?} referenceId
     * @return {?}
     */
    GlossaryComponent.prototype.onClickItem = /**
     * @param {?} referenceId
     * @return {?}
     */
    function (referenceId) {
        this.activeReferenceId = referenceId;
        this.activeItemByReferenceId(referenceId);
        this.scrollTo(referenceId);
        /** @type {?} */
        var routerTree = this.router.parseUrl(this.router.url);
        var primary = routerTree.root.children.primary;
        /** @type {?} */
        var urlWithoutParams = primary
            ? primary.segments.map((/**
             * @param {?} segment
             * @return {?}
             */
            function (segment) { return segment.path; }))
            : routerTree.root.segments.map((/**
             * @param {?} segment
             * @return {?}
             */
            function (segment) { return segment.path; }));
        this.router.navigate(urlWithoutParams, { fragment: referenceId });
    };
    /**
     * @param {?} referenceId
     * @return {?}
     */
    GlossaryComponent.prototype.activeItemByReferenceId = /**
     * @param {?} referenceId
     * @return {?}
     */
    function (referenceId) {
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item.isActive = item.referenceId === referenceId;
        }));
    };
    GlossaryComponent.defaultProps = {
        className: '',
        scrollSpy: null,
        topSpace: 0
    };
    GlossaryComponent.decorators = [
        { type: Component, args: [{
                    selector: config.components.prefix + "-glossary",
                    template: "<ul [ngClass]=\"className\">\n  <ng-content></ng-content>\n</ul>\n"
                }] }
    ];
    /** @nocollapse */
    GlossaryComponent.ctorParameters = function () { return [
        { type: Router }
    ]; };
    GlossaryComponent.propDecorators = {
        items: [{ type: ContentChildren, args: [GlossaryItemComponent,] }],
        className: [{ type: Input }],
        scrollSpy: [{ type: Input }],
        topSpace: [{ type: Input }]
    };
    return GlossaryComponent;
}());
export { GlossaryComponent };
if (false) {
    /** @type {?} */
    GlossaryComponent.defaultProps;
    /** @type {?} */
    GlossaryComponent.prototype.items;
    /** @type {?} */
    GlossaryComponent.prototype.className;
    /** @type {?} */
    GlossaryComponent.prototype.scrollSpy;
    /** @type {?} */
    GlossaryComponent.prototype.topSpace;
    /** @type {?} */
    GlossaryComponent.prototype.prefix;
    /** @type {?} */
    GlossaryComponent.prototype.activeReferenceId;
    /**
     * @type {?}
     * @private
     */
    GlossaryComponent.prototype.router;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xvc3NhcnkuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vbWF0ZXJpYWxpemUtYW5ndWxhci8iLCJzb3VyY2VzIjpbImFwcC9jb21wbGV0ZWQtY29tcG9uZW50cy9nbG9zc2FyeS9nbG9zc2FyeS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFRQSxPQUFPLEVBQWlCLFNBQVMsRUFBRSxlQUFlLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM1RixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUM5RCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSx5Q0FBeUMsQ0FBQztBQUVoRixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFekM7SUFxQkUsMkJBQW9CLE1BQWM7UUFBZCxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBUnpCLGNBQVMsR0FBRyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDO1FBQ3JELGNBQVMsR0FBRyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDO1FBQ3JELGFBQVEsR0FBRyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDO1FBRXJELFdBQU0sR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQztRQUVsQyxzQkFBaUIsR0FBRyxFQUFFLENBQUM7UUFHNUIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMvQyxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3ZELElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFB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SUFFRCxtREFBdUI7Ozs7SUFBdkIsVUFBd0IsV0FBbUI7UUFDekMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPOzs7O1FBQUMsVUFBQSxJQUFJO1lBQ3JCLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFdBQVcsS0FBSyxXQUFXLENBQUM7UUFDbkQsQ0FBQyxFQUFDLENBQUM7SUFDTCxDQUFDO0lBM0ZlLDhCQUFZLEdBQWtCO1FBQzVDLFNBQVMsRUFBRSxFQUFFO1FBQ2IsU0FBUyxFQUFFLElBQUk7UUFDZixRQUFRLEVBQUUsQ0FBQztLQUNaLENBQUM7O2dCQVRILFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxNQUFNLGNBQVk7b0JBQ2xELDhFQUF3QztpQkFDekM7Ozs7Z0JBTFEsTUFBTTs7O3dCQWFaLGVBQWUsU0FBQyxxQkFBcUI7NEJBRXJDLEtBQUs7NEJBQ0wsS0FBSzsyQkFDTCxLQUFLOztJQWtGUix3QkFBQztDQUFBLEFBakdELElBaUdDO1NBN0ZZLGlCQUFpQjs7O0lBQzVCLCtCQUlFOztJQUVGLGtDQUFnRjs7SUFFaEYsc0NBQThEOztJQUM5RCxzQ0FBOEQ7O0lBQzlELHFDQUE0RDs7SUFFNUQsbUNBQXlDOztJQUV6Qyw4Q0FBOEI7Ozs7O0lBRWxCLG1DQUFzQiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCBXb3JreWxhYi4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhbiBNSVQtc3R5bGUgbGljZW5zZSB0aGF0IGNhbiBiZVxuICogZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBhdCBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vd29ya3lsYWIvbWF0ZXJpYWxpemUtYW5ndWxhci9tYXN0ZXIvTElDRU5TRVxuICovXG5cbmltcG9ydCB7IEFmdGVyVmlld0luaXQsIENvbXBvbmVudCwgQ29udGVudENoaWxkcmVuLCBJbnB1dCwgUXVlcnlMaXN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICcuLi8uLi9jb25maWcnO1xuaW1wb3J0IHsgZ2V0T2Zmc2VUb3AgfSBmcm9tICcuLi8uLi91dGlscy9nZXQtb2Zmc2V0LXRvcC51dGlsJztcbmltcG9ydCB7IEdsb3NzYXJ5SXRlbUNvbXBvbmVudCB9IGZyb20gJy4vZ2xvc3NhcnktaXRlbS9nbG9zc2FyeS1pdGVtLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBHbG9zc2FyeU1vZGVsIH0gZnJvbSAnLi9nbG9zc2FyeS5tb2RlbCc7XG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6IGAkeyBjb25maWcuY29tcG9uZW50cy5wcmVmaXggfS1nbG9zc2FyeWAsXG4gIHRlbXBsYXRlVXJsOiAnLi9nbG9zc2FyeS5jb21wb25lbnQuaHRtbCdcbn0pXG5leHBvcnQgY2xhc3MgR2xvc3NhcnlDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBHbG9zc2FyeU1vZGVsIHtcbiAgc3RhdGljIHJlYWRvbmx5IGRlZmF1bHRQcm9wczogR2xvc3NhcnlNb2RlbCA9IHtcbiAgICBjbGFzc05hbWU6ICcnLFxuICAgIHNjcm9sbFNweTogbnVsbCxcbiAgICB0b3BTcGFjZTogMFxuICB9O1xuXG4gIEBDb250ZW50Q2hpbGRyZW4oR2xvc3NhcnlJdGVtQ29tcG9uZW50KSBpdGVtczogUXVlcnlMaXN0PEdsb3NzYXJ5SXRlbUNvbXBvbmVudD47XG5cbiAgQElucHV0KCkgY2xhc3NOYW1lID0gR2xvc3NhcnlDb21wb25lbnQuZGVmYXVsdFByb3BzLmNsYXNzTmFtZTtcbiAgQElucHV0KCkgc2Nyb2xsU3B5ID0gR2xvc3NhcnlDb21wb25lbnQuZGVmYXVsdFByb3BzLnNjcm9sbFNweTtcbiAgQElucHV0KCkgdG9wU3BhY2UgPSBHbG9zc2FyeUNvbXBvbmVudC5kZWZhdWx0UHJvcHMudG9wU3BhY2U7XG5cbiAgcHVibGljIHByZWZpeCA9IGNvbmZpZy5jb21wb25lbnRzLnByZWZpeDtcblxuICBwdWJsaWMgYWN0aXZlUmVmZXJlbmNlSWQgPSAnJztcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJvdXRlcjogUm91dGVyKSB7XG4gICAgdGhpcy5vbkNsaWNrSXRlbSA9IHRoaXMub25DbGlja0l0ZW0uYmluZCh0aGlzKTtcbiAgICB0aGlzLnJlZ2lzdGVyT3B0aW9ucyA9IHRoaXMucmVnaXN0ZXJPcHRpb25zLmJpbmQodGhpcyk7XG4gICAgdGhpcy51cGRhdGUgPSB0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHRoaXMucmVnaXN0ZXJPcHRpb25zKCk7XG5cbiAgICBzZXRUaW1lb3V0KHRoaXMudXBkYXRlLCAzMCk7XG5cbiAgICBpZiAodGhpcy5zY3JvbGxTcHkpIHtcbiAgICAgIHRoaXMuc2Nyb2xsU3B5Lm9uQ2hhbmdlRW1pdHRlci5zdWJzY3JpYmUoKHJlZmVyZW5jZUlkOiBzdHJpbmcpID0+IHtcbiAgICAgICAgdGhpcy5hY3RpdmVSZWZlcmVuY2VJZCA9IHJlZmVyZW5jZUlkO1xuXG4gICAgICAgIHRoaXMuYWN0aXZlSXRlbUJ5UmVmZXJlbmNlSWQocmVmZXJlbmNlSWQpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgdXBkYXRlKCkge1xuICAgIHRoaXMuYWN0aXZlUmVmZXJlbmNlSWQgPSB0aGlzLmdldEFjdGl2ZVJlZmVyZW5jZUlkKCk7XG5cbiAgICB0aGlzLmFjdGl2ZUl0ZW1CeVJlZmVyZW5jZUlkKHRoaXMuYWN0aXZlUmVmZXJlbmNlSWQpO1xuXG4gICAgdGhpcy5zY3JvbGxUbyh0aGlzLmFjdGl2ZVJlZmVyZW5jZUlkKTtcbiAgfVxuXG4gIHNjcm9sbFRvKHJlZmVyZW5jZUlkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVmZXJlbmNlSWQpO1xuXG4gICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgIGNvbnN0IGVsZW1lbnRPZmZzZXRUb3AgPSBnZXRPZmZzZVRvcChlbGVtZW50KTtcbiAgICAgIGNvbnN0IHNjcm9sbFRvcCA9IGVsZW1lbnRPZmZzZXRUb3AgLSB0aGlzLnRvcFNwYWNlO1xuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHdpbmRvdy5zY3JvbGxUbygwLCBzY3JvbGxUb3ApLCAxNTApO1xuICAgIH1cbiAgfVxuXG4gIGdldEFjdGl2ZVJlZmVyZW5jZUlkKCk6IHN0cmluZyB7XG4gICAgY29uc3Qgcm91dGVyVHJlZSA9IHRoaXMucm91dGVyLnBhcnNlVXJsKHRoaXMucm91dGVyLnVybCk7XG5cbiAgICBpZiAocm91dGVyVHJlZSAmJiByb3V0ZXJUcmVlLmZyYWdtZW50KSB7XG4gICAgICByZXR1cm4gcm91dGVyVHJlZS5mcmFnbWVudDtcbiAgICB9XG5cbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICByZWdpc3Rlck9wdGlvbnMoKSB7XG4gICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgaXRlbS5vbkNsaWNrRW1pdHRlci5zdWJzY3JpYmUodGhpcy5vbkNsaWNrSXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBvbkNsaWNrSXRlbShyZWZlcmVuY2VJZDogc3RyaW5nKSB7XG4gICAgdGhpcy5hY3RpdmVSZWZlcmVuY2VJZCA9IHJlZmVyZW5jZUlkO1xuXG4gICAgdGhpcy5hY3RpdmVJdGVtQnlSZWZlcmVuY2VJZChyZWZlcmVuY2VJZCk7XG4gICAgdGhpcy5zY3JvbGxUbyhyZWZlcmVuY2VJZCk7XG5cbiAgICBjb25zdCByb3V0ZXJUcmVlID0gdGhpcy5yb3V0ZXIucGFyc2VVcmwodGhpcy5yb3V0ZXIudXJsKTtcbiAgICBjb25zdCB7IHByaW1hcnkgfSA9IHJvdXRlclRyZWUucm9vdC5jaGlsZHJlbjtcblxuICAgIGNvbnN0IHVybFdpdGhvdXRQYXJhbXMgPSBwcmltYXJ5XG4gICAgICA/IHByaW1hcnkuc2VnbWVudHMubWFwKHNlZ21lbnQgPT4gc2VnbWVudC5wYXRoKVxuICAgICAgOiByb3V0ZXJUcmVlLnJvb3Quc2VnbWVudHMubWFwKHNlZ21lbnQgPT4gc2VnbWVudC5wYXRoKTtcblxuICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKHVybFdpdGhvdXRQYXJhbXMsIHsgZnJhZ21lbnQ6IHJlZmVyZW5jZUlkIH0pO1xuICB9XG5cbiAgYWN0aXZlSXRlbUJ5UmVmZXJlbmNlSWQocmVmZXJlbmNlSWQ6IHN0cmluZykge1xuICAgIHRoaXMuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIGl0ZW0uaXNBY3RpdmUgPSBpdGVtLnJlZmVyZW5jZUlkID09PSByZWZlcmVuY2VJZDtcbiAgICB9KTtcbiAgfVxufVxuIl19